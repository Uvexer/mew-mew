# TodoAppFour - iOS Time Management & Gamification App

## Описание проекта

TodoAppFour - это современное iOS-приложение для управления задачами с элементами игрофикации, разработанное с использованием SwiftUI и Core Data. Приложение помогает пользователям организовывать свои задачи, отслеживать прогресс и поддерживать мотивацию через систему очков, уровней и достижений.

## Основные возможности

### Управление задачами
- **Создание задач** с заголовком, описанием, приоритетом и категорией
- **Три уровня приоритета**: Low (10 очков), Medium (20 очков), High (30 очков)
- **Установка сроков выполнения** с визуальной индикацией просроченных задач
- **Фильтрация задач** по статусу (все, активные, завершённые) и категориям
- **Удаление задач** с подтверждением

### Категории
- **Предустановленные категории**: Work, Personal, Shopping, Health
- Каждая категория имеет **уникальный цвет и иконку**
- **Быстрая фильтрация** задач по категориям

### Игровые элементы
- **Система очков**: получение очков за выполнение задач (в зависимости от приоритета)
- **Система уровней**: повышение уровня каждые 100 очков
- **Streak-система**: отслеживание ежедневной серии выполнения задач
- **Статистика**: общее количество очков, выполненных задач, текущая и лучшая серия

## Технические требования

- **iOS**: 16.0+
- **Xcode**: 15.0+
- **Swift**: 5.9+
- **Зависимости**: отсутствуют (только нативные фреймворки)

## Архитектура

Приложение построено на архитектуре **MVVM (Model-View-ViewModel)** с четким разделением ответственности:

```
todoAppFour/
├── Models/               # Модели данных
│   ├── TodoItem.swift
│   ├── Category.swift
│   └── GameStats.swift
├── CoreData/            # Core Data Stack
│   ├── TodoApp.xcdatamodeld
│   └── CoreDataStack.swift
├── Services/            # Слой работы с данными
│   ├── TodoService.swift
│   ├── CategoryService.swift
│   └── GameStatsService.swift
├── ViewModels/          # Бизнес-логика
│   └── TodoListViewModel.swift
├── Views/               # Интерфейс
│   ├── ContentView.swift
│   ├── AddTodoView.swift
│   ├── GameStatsView.swift
│   └── Components/
│       ├── TodoRowView.swift
│       └── CategoryFilterChip.swift
└── todoAppFourApp.swift # Точка входа
```

### Слои приложения

#### 1. Models
Простые Swift структуры, представляющие бизнес-сущности:
- `TodoItem` - задача с полями: id, title, notes, isCompleted, priority, dates, categoryId
- `Category` - категория с полями: id, name, colorHex, icon
- `GameStats` - игровая статистика с полями: totalPoints, completedTasksCount, streaks, level

#### 2. Core Data
- **Core Data Model**: определяет три сущности (TodoItemEntity, CategoryEntity, GameStatsEntity)
- **CoreDataStack**: инкапсулирует NSPersistentContainer и управление контекстами
- Автоматическое слияние изменений из фоновых контекстов
- Безопасная работа с главным потоком через @MainActor

#### 3. Services
Слой абстракции для работы с Core Data:
- **TodoService**: CRUD операции для задач, toggle completion
- **CategoryService**: управление категориями, инициализация дефолтных категорий
- **GameStatsService**: обновление статистики, подсчет очков, управление streak
- Все сервисы логируют важные операции через os.Logger
- Обработка ошибок без использования fatalError

#### 4. ViewModels
- **TodoListViewModel**: управление состоянием приложения
  - Загрузка и кэширование данных
  - Фильтрация задач
  - Координация работы сервисов
  - Публикация изменений через @Published
  - Асинхронные операции через async/await

#### 5. Views
SwiftUI views с минимальной логикой:
- **ContentView**: главный экран со списком задач
- **AddTodoView**: форма создания задачи
- **GameStatsView**: экран статистики с прогрессом
- **Components**: переиспользуемые компоненты (TodoRowView, CategoryFilterChip)

## Работа с Core Data

### Структура данных

**TodoItemEntity**
- id: UUID (уникальный идентификатор)
- title: String (название задачи)
- notes: String? (дополнительные заметки)
- isCompleted: Bool (статус выполнения)
- priority: Int16 (приоритет: 1-Low, 2-Medium, 3-High)
- createdAt: Date (дата создания)
- completedAt: Date? (дата завершения)
- dueDate: Date? (срок выполнения)
- category: Relationship to CategoryEntity

**CategoryEntity**
- id: UUID
- name: String
- colorHex: String (цвет в hex формате)
- icon: String (SF Symbol name)
- createdAt: Date
- items: Relationship to TodoItemEntity (cascade delete)

**GameStatsEntity**
- id: UUID
- totalPoints: Int64
- completedTasksCount: Int64
- currentStreak: Int64
- bestStreak: Int64
- lastCompletionDate: Date?
- level: Int64

### Core Data Stack

Инициализация через NSPersistentContainer:
```swift
CoreDataStack.shared.persistentContainer
```

Основные возможности:
- Автоматическое слияние изменений из родительского контекста
- Merge policy: NSMergeByPropertyObjectTrumpMergePolicy
- Безопасное сохранение через @MainActor
- Поддержка фоновых контекстов для тяжелых операций

### Логика сохранения

1. Все операции записи выполняются на главном потоке (@MainActor)
2. Изменения сохраняются через `CoreDataStack.shared.save()`
3. Проверка наличия изменений перед сохранением (`context.hasChanges`)
4. Логирование всех операций через os.Logger
5. Корректная обработка ошибок с throw

## Инструкция по запуску

### Локальная разработка

1. **Клонируйте или откройте проект**
   ```bash
   open todoAppFour.xcodeproj
   ```

2. **Выберите целевое устройство**
   - В Xcode выберите симулятор или физическое устройство
   - Рекомендуется: iPhone 15 Pro (iOS 17.0+)

3. **Соберите и запустите проект**
   - Нажмите ⌘R или кнопку "Run"
   - Приложение должно собраться без ошибок и предупреждений

4. **Первый запуск**
   - Core Data автоматически создаст базу данных
   - Инициализируются 4 категории по умолчанию
   - Создается запись GameStats с нулевыми значениями

### Тестирование

**Основные сценарии:**

1. **Создание задачи**
   - Нажмите "+" в правом верхнем углу
   - Заполните название (обязательно)
   - Опционально: notes, priority, category, due date
   - Нажмите "Add"

2. **Фильтрация**
   - Переключайте между All/Active/Completed
   - Выбирайте категории в горизонтальном скролле

3. **Выполнение задачи**
   - Нажмите на круг слева от задачи
   - Задача помечается выполненной
   - Начисляются очки (10/20/30 в зависимости от приоритета)
   - Обновляется streak

4. **Просмотр статистики**
   - Нажмите на счетчик очков в левом верхнем углу
   - Просмотрите уровень, прогресс, статистику

5. **Удаление задачи**
   - Нажмите на иконку корзины
   - Подтвердите удаление

## Адаптивность и доступность

### Поддержка устройств
- iPhone SE (маленький экран)
- Все модели iPhone с iOS 16+
- iPad (портрет и альбомная ориентация)
- Split View на iPad

### Адаптивная верстка
- Использование GeometryReader для динамических размеров
- Относительные размеры вместо жестко заданных значений
- Поддержка различных размеров текста (Dynamic Type)

### Темы
- Полная поддержка светлой темы
- Полная поддержка тёмной темы
- Использование семантических цветов (Color.primary, .secondary, .accentColor)

## Производительность

### Оптимизации
- Ленивая загрузка списков через List
- Минимизация перерисовок через @Published
- Правильное использование @MainActor
- Отсутствие тяжелых вычислений в body
- Кэширование данных в ViewModel

### Логирование
- Использование os.Logger для всех логов
- Логирование только важных событий:
  - Операции с Core Data
  - Создание/изменение/удаление сущностей
  - Начисление очков
  - Ошибки
- Отсутствие логирования персональных данных

## Сборка для App Store

1. **Настройка Bundle Identifier**
   - Откройте проект в Xcode
   - Выберите Target > Signing & Capabilities
   - Установите уникальный Bundle ID

2. **Настройка Team**
   - Выберите Development Team
   - Включите Automatically manage signing

3. **Версионирование**
   - Установите Version и Build Number
   - Следуйте семантическому версионированию

4. **Создание архива**
   - Product > Archive
   - Дождитесь завершения сборки
   - Откроется Organizer

5. **Загрузка в App Store Connect**
   - В Organizer нажмите "Distribute App"
   - Выберите "App Store Connect"
   - Следуйте инструкциям мастера

## Известные ограничения

- Отсутствие синхронизации между устройствами (только локальное хранение)
- Нельзя редактировать существующие задачи (только создание и удаление)
- Нельзя создавать/редактировать/удалять категории через UI
- Отсутствие уведомлений о сроках задач

## Возможности для расширения

1. **Редактирование задач**: добавить экран редактирования
2. **Управление категориями**: CRUD интерфейс для категорий
3. **Push-уведомления**: напоминания о задачах
4. **iCloud Sync**: синхронизация между устройствами
5. **Widgets**: виджеты для главного экрана
6. **Поиск**: поиск задач по названию и описанию
7. **Сортировка**: различные варианты сортировки
8. **Темы**: кастомизация цветовой схемы
9. **Экспорт**: экспорт данных в различных форматах
10. **Достижения**: система бейджей и наград

## Лицензия и контакты

Проект создан как учебное приложение для демонстрации современных практик iOS-разработки.

**Технологический стек:**
- Swift 5.9+
- SwiftUI
- Core Data
- Async/Await
- MVVM Architecture
- os.Logger

**Требования к разработке:**
- Без сторонних зависимостей
- Чистый, читаемый код
- Самодокументируемый код (без комментариев)
- Правильная обработка ошибок
- Производительный и стабильный

