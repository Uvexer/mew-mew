# Ball Physics Game - iOS Application

## Описание проекта

Ball Physics Game - это интерактивное iOS-приложение, демонстрирующее физическую симуляцию мячика с реалистичной гравитацией, отскоками и управляемой платформой. Приложение разработано на Swift с использованием SwiftUI и следует архитектурному паттерну MVVM.

## Основные возможности

- **Физическая симуляция**: Реалистичная физика мячика с настраиваемыми параметрами (гравитация, упругость отскока, сопротивление воздуха)
- **Интерактивная платформа**: Управление платформой через жесты для отбивания мячика
- **Система очков**: Подсчет отскоков с отслеживанием рекорда
- **Настройки физики**: Возможность настройки параметров физической симуляции
- **Сохранение прогресса**: Автоматическое сохранение игровых данных через Core Data
- **Адаптивный интерфейс**: Поддержка разных размеров экранов и ориентаций (портретная/альбомная)
- **Темная тема**: Полная поддержка светлой и темной темы iOS

## Технические требования

- **Минимальная версия iOS**: 16.0
- **Язык программирования**: Swift 5.0
- **Фреймворк UI**: SwiftUI
- **Хранилище данных**: Core Data
- **Архитектура**: MVVM (Model-View-ViewModel)
- **Асинхронность**: async/await

## Структура проекта

```
ballAppOne/
├── Models/                          # Модели данных
│   ├── Ball.swift                   # Модель мячика
│   ├── Platform.swift               # Модель платформы
│   └── PhysicsSettings.swift        # Настройки физики
├── CoreData/                        # Core Data сущности
│   └── GameSessionEntity.swift      # Сущность игровой сессии
├── Services/                        # Сервисный слой
│   ├── CoreDataService.swift        # Сервис работы с Core Data
│   └── PhysicsService.swift         # Сервис физической симуляции
├── ViewModels/                      # View Models
│   └── GameViewModel.swift          # ViewModel для игры
├── Views/                           # Views
│   ├── GameView.swift               # Главный экран игры
│   ├── SettingsView.swift           # Экран настроек
│   └── Components/                  # Переиспользуемые компоненты
│       ├── BallView.swift           # Визуализация мячика
│       └── PlatformView.swift       # Визуализация платформы
├── BallAppModel.xcdatamodeld/       # Core Data модель
└── Assets.xcassets/                 # Графические ресурсы
```

## Инструкция по запуску

### Предварительные требования

1. macOS с установленным Xcode 15.0 или выше
2. iOS симулятор или физическое устройство с iOS 16.0+
3. Активный Apple Developer аккаунт (для запуска на физическом устройстве)

### Шаги запуска

1. **Открыть проект**
   ```bash
   open ballAppOne.xcodeproj
   ```

2. **Выбрать целевое устройство**
   - В Xcode выберите симулятор или подключенное устройство в верхней панели

3. **Запустить приложение**
   - Нажмите ⌘R или кнопку "Play" в Xcode
   - Приложение скомпилируется и запустится на выбранном устройстве

### Возможные проблемы

- **Ошибка подписи кода**: Убедитесь, что в настройках проекта указана корректная команда разработчика (Development Team)
- **Проблемы с симулятором**: Попробуйте перезапустить симулятор или выбрать другую версию iOS

## Архитектура и основная логика

### MVVM Pattern

Приложение строго следует архитектуре MVVM:

- **Models** (`Ball`, `Platform`, `PhysicsSettings`): Содержат данные без бизнес-логики
- **Views** (`GameView`, `SettingsView`, компоненты): Только отображение, без вычислений
- **ViewModels** (`GameViewModel`): Управление состоянием, бизнес-логика, взаимодействие с сервисами

### Сервисный слой

#### CoreDataService
- Инкапсулирует всю работу с Core Data
- Управляет `NSPersistentContainer` и контекстами
- Предоставляет методы для сохранения и загрузки игровых сессий
- Использует `@MainActor` для безопасной работы с UI потоком
- Логирует все операции через `os.Logger`

#### PhysicsService
- Реализует физическую симуляцию мячика
- Обрабатывает столкновения с границами и платформой
- Применяет гравитацию, упругость и сопротивление воздуха
- Работает с deltaTime для плавной анимации независимо от частоты кадров

### Core Data

#### Модель данных

Приложение использует одну сущность `GameSessionEntity`:

- `id`: UUID - уникальный идентификатор сессии
- `bounces`: Int32 - текущее количество отскоков
- `highScore`: Int32 - лучший результат
- `gravity`: Double - значение гравитации
- `bounciness`: Double - коэффициент упругости (0-1)
- `airResistance`: Double - сопротивление воздуха (0.9-1)
- `lastPlayed`: Date - время последней игры

#### Принципы работы

1. **Автоматическое сохранение**: Состояние игры сохраняется при паузе и изменении настроек
2. **Восстановление состояния**: При запуске приложения загружается последняя сессия
3. **Merge policy**: Используется `NSMergeByPropertyObjectTrumpMergePolicy` для разрешения конфликтов
4. **Main thread safety**: Все операции с контекстом выполняются на главном потоке через `@MainActor`

### Физика игры

#### Параметры симуляции

- **Gravity** (100-2000): Сила притяжения, влияет на ускорение падения мячика
- **Bounciness** (0-1): Коэффициент упругости отскока (1 = полностью упругий, 0 = нет отскока)
- **Air Resistance** (0.9-1): Замедление движения (1 = нет сопротивления, 0.9 = сильное сопротивление)

#### Алгоритм физики

1. Применяется гравитационное ускорение: `velocity.dy += gravity * deltaTime`
2. Применяется сопротивление воздуха: `velocity *= airResistance`
3. Обновляется позиция: `position += velocity * deltaTime`
4. Проверяются столкновения с границами и платформой
5. При столкновении применяется коэффициент упругости

### Логирование

Приложение использует `os.Logger` для структурированного логирования:

- **Категория "CoreData"**: Логи операций с базой данных
- **Категория "Physics"**: Логи физических событий (отскоки, столкновения)
- **Категория "Game"**: Логи игровых событий (старт, пауза, новый рекорд)

Логи не содержат персональных данных и используются только для отладки.

## Игровой процесс

### Управление

1. **Запуск игры**: Нажмите кнопку "Play"
2. **Управление платформой**: Перемещайте палец по экрану для движения платформы
3. **Цель**: Не дайте мячику упасть, отбивая его платформой
4. **Пауза**: Нажмите "Pause" для приостановки игры
5. **Сброс**: Нажмите "Reset" для начала новой игры

### Система очков

- Каждый отскок от платформы добавляет 1 очко
- Лучший результат автоматически сохраняется
- При падении мячика игра останавливается

### Настройки

Откройте экран настроек (иконка шестеренки) для изменения:
- Силы гравитации
- Упругости отскоков
- Сопротивления воздуха

Изменения применяются сразу после сохранения.

## Адаптивность и совместимость

### Поддерживаемые устройства

- iPhone SE (1-го поколения) и новее
- Все модели iPad
- iPhone 16 Pro Max и другие большие модели

### Ориентации

- **iPhone**: Портретная ориентация
- **iPad**: Все ориентации (портретная, альбомная, Split View)

### Адаптивность

Весь интерфейс использует:
- `GeometryReader` для динамических размеров
- Относительное позиционирование вместо фиксированных значений
- Стандартные контейнеры SwiftUI для правильной верстки

## Производительность

- **Частота обновления**: 60 FPS
- **Оптимизация отрисовки**: Минимальное количество перерисовок SwiftUI
- **Управление памятью**: Нет утечек, корректное освобождение ресурсов
- **Delta time**: Независимость физики от частоты кадров

## Подготовка к релизу

### Перед загрузкой в App Store Connect

1. **Проверьте Bundle Identifier**: Убедитесь, что указан уникальный идентификатор
2. **Обновите иконку**: Добавьте все необходимые размеры иконки в `Assets.xcassets/AppIcon.appiconset`
3. **Заполните метаданные**: Убедитесь, что заполнены все поля в Info.plist
4. **Тестирование**: Протестируйте на разных устройствах и версиях iOS
5. **Создайте архив**: Product → Archive в Xcode
6. **Загрузите в App Store Connect**: Window → Organizer → Distribute App

### Рекомендации

- Добавьте скриншоты для App Store
- Подготовьте описание приложения
- Укажите ключевые слова для поиска
- Добавьте Privacy Policy при необходимости

## Лицензия и поддержка

Проект готов к использованию и дальнейшей разработке. Все зависимости являются нативными Apple фреймворками.

## Контакты разработчика

Для вопросов и предложений по улучшению приложения обращайтесь к разработчику проекта.

---

**Версия**: 1.0  
**Дата создания**: Январь 2026  
**Минимальная версия iOS**: 16.0

